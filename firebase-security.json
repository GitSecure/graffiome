{
  "rules": {
    "sites": {
      ".read": "auth != null",
      ".write": "auth != null",
      ".validate": "newData.isString() && newData.val().length === 40",
      "$site": {
        "$user": {
          ".read": "auth != null",
          ".write": "$user == auth.uid",
          ".validate": "newData.isString() && newData.val().matches(/^data:image\/png;base64\,[a-z,A-Z,0-9,\+,\/]*$/)"
        }
      }
    }
  }
}
